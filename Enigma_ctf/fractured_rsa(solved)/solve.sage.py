

# This file was *autogenerated* from the file solve.sage
from sage.all_cmdline import *   # import sage library

_sage_const_91838392436240503331712774858466175701943413315322225051619596529851993904079670234071457721426498873741584982531153498950691825618069096013454981926893433738150353153143279482383739121164274011329469871904925869165461464474403257196633053437505571229335243756784591951401736674559821793496918982152118235017 = Integer(91838392436240503331712774858466175701943413315322225051619596529851993904079670234071457721426498873741584982531153498950691825618069096013454981926893433738150353153143279482383739121164274011329469871904925869165461464474403257196633053437505571229335243756784591951401736674559821793496918982152118235017); _sage_const_65537 = Integer(65537); _sage_const_4092240954031020785790852242303837214733355291076513085754622688235225835575277350063649697959294573249580037102991729522634639647348866656859757725636445738209685267524388862151853265672769726968577605819562167892539374143132425880944383491629187881404426192623442821140365568838900507845759302572175625919 = Integer(4092240954031020785790852242303837214733355291076513085754622688235225835575277350063649697959294573249580037102991729522634639647348866656859757725636445738209685267524388862151853265672769726968577605819562167892539374143132425880944383491629187881404426192623442821140365568838900507845759302572175625919); _sage_const_90832678244828575901502228077873044848423784837881215448557569301837036198770581553934213601743544299375081572394088859590937520703067629222089425569632363397430134047111700899828825903421330414123531257995919690385731463583767317272840450335992970852639723123504718994178146938027604531515234013744684414027 = Integer(90832678244828575901502228077873044848423784837881215448557569301837036198770581553934213601743544299375081572394088859590937520703067629222089425569632363397430134047111700899828825903421330414123531257995919690385731463583767317272840450335992970852639723123504718994178146938027604531515234013744684414027); _sage_const_58 = Integer(58); _sage_const_0 = Integer(0); _sage_const_1 = Integer(1)
from Crypto.Util.number import long_to_bytes

# [cite_start]Data from chall.bin [cite: 1]
n = _sage_const_91838392436240503331712774858466175701943413315322225051619596529851993904079670234071457721426498873741584982531153498950691825618069096013454981926893433738150353153143279482383739121164274011329469871904925869165461464474403257196633053437505571229335243756784591951401736674559821793496918982152118235017 
e = _sage_const_65537 
c1 = _sage_const_4092240954031020785790852242303837214733355291076513085754622688235225835575277350063649697959294573249580037102991729522634639647348866656859757725636445738209685267524388862151853265672769726968577605819562167892539374143132425880944383491629187881404426192623442821140365568838900507845759302572175625919 
c2 = _sage_const_90832678244828575901502228077873044848423784837881215448557569301837036198770581553934213601743544299375081572394088859590937520703067629222089425569632363397430134047111700899828825903421330414123531257995919690385731463583767317272840450335992970852639723123504718994178146938027604531515234013744684414027 
diff = _sage_const_58 

P = PolynomialRing(Zmod(n), names=('x',)); (x,) = P._first_ngens(1)
f1 = x**e - c1
f2 = (x + diff)**e - c2

# This approach finds the common root by taking the GCD of the two polynomials
# If the standard GCD is slow, we use this variation:
def franklin_reiter(f1, f2):
    while f2 != _sage_const_0 :
        f1, f2 = f2, f1 % f2
    return -f1.coefficients()[_sage_const_0 ] / f1.coefficients()[_sage_const_1 ]

print("Calculating... this may take 1-5 minutes depending on CPU.")
m1 = franklin_reiter(f1, f2)
print(f"Flag: {long_to_bytes(int(m1)).decode()}")

